<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
          integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
          integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <link rel="stylesheet" href="//malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css">

    <link rel="stylesheet" th:href="@{assert/css/main.css}" href="../static/assert/css/main.css">
    <link rel="stylesheet" th:href="@{assert/css/sidebar-themes.css}" href="../static/assert/css/sidebar-themes.css">
    <link rel="shortcut icon" th:href="@{assert/img/favicon.png}" type="image/png"
          href="../static/assert/img/favicon.png"/>


</head>
<body>
<div class="page-wrapper default-theme sidebar-bg bg1 toggled">
    <nav id="sidebar" class="sidebar-wrapper">
        <div class="sidebar-content">
            <!-- sidebar-brand  -->
            <div class="sidebar-item sidebar-brand">
                <a href="">Student System</a>
            </div>
            <!-- sidebar-header  -->
            <div class="sidebar-item sidebar-header d-flex flex-nowrap">
                <div class="user-info">
                        <span class="user-name">Student
                            <strong>Attendance</strong>
                        </span>
                    <span class="user-role">Student</span>
                    <span class="user-status">
                            <i class="fa fa-circle"></i>
                            <span>Online</span>
                        </span>
                </div>
            </div>
            <!-- sidebar-menu  -->
            <div class=" sidebar-item sidebar-menu">
                <ul>
                    <li class="header-menu">
                        <span>General</span>
                    </li>
                    <a href="#">
                    <li class="sidebar-dropdown active">
                            <i class="fa fa-tachometer-alt"></i>
                            <span class="menu-text">New Student</span>
                            <span class="badge badge-pill badge-warning">New</span>
                    </a>
                        <div class="sidebar-submenu" style="display:block">
                            <ul>
                                <li>
                                    <a href="imgcapture">Image capture and sign up
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <div class="sidebar-submenu" style="display:block">
                            <ul>
                                <li>
                                    <a href="joinsubject">Choose Subject
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="sidebar-dropdown active">
                        <a href="#">
                            <i class="fa fa-shopping-cart"></i>
                            <span class="menu-text">check in</span>
                        </a>
                        <div class="sidebar-submenu" style="display: block">
                            <ul>
                                <li>
                                    <a href="index">check in

                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="sidebar-dropdown">
                        <a href="#">
                            <i class="far fa-gem"></i>
                            <span class="menu-text">Components</span>
                        </a>

                    </li>
                </ul>
            </div>
            <!-- sidebar-menu  -->
        </div>
    </nav>
    <main class="page-content pt-2">
        <div id="overlay" class="overlay"></div>
        <div class="container-fluid p-5">
            <div class="row">
                <div class="form-group col-md-12">

                    <form id="form1">
                        <table border="0">
                            <tr>
                                <td>
                                   Enter Picture Name First(Student name)ï¼š
                                </td>
                                <td>
                                    <input id="Stuname" name="Stuname" type="text"/>
                                </td>
                            </tr>
                        </table>
                    </form>
                    <div class="videoplay"> <video autoplay></video>
                        <button id="button">capture</button>
                        <canvas id="canvas"></canvas>
                    </div>


                </div>
                <form action="/InsertStudent" method="post">

                    <div class="form-group">
                        <label>Name:</label>
                        <input class="form-control" name="name" placeholder="Enter name:">
                    </div>
                    <div class="form-group">
                        <label>GUID</label>
                        <input class="form-control" name="Sid" placeholder="Enter GUID">
                    </div>
                    <div class="form-group">
                        <label>SEX</label>
                        <input class="form-control" name="sex" placeholder="Enter sex">
                    </div>
                    <button type="submit" class="btn btn-primary">Sign Up</button>
                </form>


                <script type="text/javascript">
                    var video = document.querySelector('video');
                    var canvas = window.canvas = document.querySelector('canvas');
                    var button = document.getElementById('button');

                    button.onclick = function () {
                        var Stuname = document.getElementById("Stuname").value;
                        Stuname=Stuname.split(' ').join('_');
                        alert(Stuname);
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width / 2, canvas.height / 2);
                        var imageDataB64 = canvas.toDataURL("image/png");
                        imageDataB64 = imageDataB64.replace(/\+/g, "%2B");
                        var result = "&imgurl=" + imageDataB64 + "&Stuname=" + Stuname;
                        var img = document.createElement("img");
                        img.src = imageDataB64;
                        img.click();
                        document.querySelector("body").appendChild(img);
                        img.style = "display: none"
                        $.ajax({
                            url: "/imgcapture1",
                            type: "POST",
                            data: result,
                            dataType: "json",
                        });

                    };

                    var constraints = {
                        audio: true,
                        video: true
                    };

                    function handleSuccess(stream) {
                        window.stream = stream; // make stream available to browser console
                        video.srcObject = stream;
                    }

                    function handleError(error) {
                        console.log('navigator.getUserMedia error: ', error);
                    }

                    navigator.mediaDevices.getUserMedia(constraints).then(handleSuccess).catch(handleError);
                </script>
            </div>
        </div>
    </main>
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous">
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous">
</script>
<script src="//malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
<script th:href="@{assert/js/main.js}" href="../static/assert/js/main.js"></script>
</body>
</html>